<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="TFSDataSource">
      <DataSourceReference>/Data Sources/TFS02Source</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>29e586bd-b7c6-41f7-ad9f-8c5f6a32205f</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="Builds">
      <Query>
        <DataSourceName>TFSDataSource</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@BuildDate">
            <Value>=Parameters!BuildDate.Value</Value>
            <rd:UserDefined>true</rd:UserDefined>
          </QueryParameter>
          <QueryParameter Name="@pBuildDefinitions">
            <Value>=Parameters!BuildDefinitions.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@NumberOfDays">
            <Value>=Parameters!NumberOfDays.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@TeamProject">
            <Value>=Parameters!TeamProject.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>Declare @BuildBK NVARCHAR(260)

CREATE TABLE #Builds
(
	BuildBK nvarchar(64)
);

INSERT #Builds
select  BuildBK
 from BuildDetailsView
 where BuildDefinitionName IN (@pBuildDefinitions)
 AND DATEDIFF(dd,BuildStartTime, @BuildDate) &lt; @NumberOfDays;
 
 --select * from #Builds
WITH BuildDetails (
	TeamProjectProjectNodeName
	,BuildDefinitionName
	,BuildName
	,BuildStartTime
	,BuildDuration
	,BuildStatusName
	,ResultOutcome
	,ResultTest
	,ResultErrorMessage
	,ResultDuration
	,LastUpdatedByName
	,BuildType
	,PassedCount
	,FailedCount
)
 AS (
SELECT
	bdv.TeamProjectProjectNodeName
	,bdv.BuildDefinitionName
	,bdv.BuildName
	,bdv.BuildStartTime
	,bdv.BuildDuration
	,bdv.BuildStatusName
	,trv.ResultOutcome
	,trv.ResultTest
	,trv.ResultErrorMessage
	,trv.ResultDuration
	,bdv.LastUpdatedByName
	,bdv.BuildType
	,PassedCount = case trv.ResultOutcome 
		when 'Passed' then 1
		else 0
		end
	,FailedCount = case 
		when trv.ResultOutcome = 'Passed' then 0
		when trv.ResultOutcome is null then 0
		else 1
		end
 from BuildDetailsView bdv 
	INNER Join #Builds b on bdv.BuildBK = b.BuildBK
	LEFT OUTER Join TestResultView trv on bdv.BuildBK = trv.BuildBK
	WHERE bdv.TeamProjectProjectNodeName like @TeamProject
 )
 SELECT bd.*, MAX(bd1.BuildStartTime) as LastPassed
  FROM BuildDetails bd
 LEFT OUTER JOIN BuildDetails bd1 on  bd.BuildDefinitionName = bd1.BuildDefinitionName and bd.ResultTest = bd1.ResultTest and bd1.ResultOutcome = 'Passed'
 GROUP BY bd.BuildDefinitionName, bd.BuildName, bd.BuildStartTime, bd.TeamProjectProjectNodeName, bd.BuildDuration, bd.BuildStatusName, bd.ResultOutcome, bd.ResultTest, bd.ResultErrorMessage, bd.ResultDuration, bd.LastUpdatedByName, bd.BuildType, bd.PassedCount, bd.FailedCount;

 DROP TABLE #Builds</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="TeamProjectProjectNodeName">
          <DataField>TeamProjectProjectNodeName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DaysFailing">
          <Value>=DateDiff(DateInterval.Day,Fields!LastPassed.Value,Parameters!BuildDate.Value)</Value>
        </Field>
        <Field Name="BuildDefinitionName">
          <DataField>BuildDefinitionName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BuildName">
          <DataField>BuildName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BuildStartTime">
          <DataField>BuildStartTime</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="BuildDuration">
          <DataField>BuildDuration</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="BuildStatusName">
          <DataField>BuildStatusName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ResultOutcome">
          <DataField>ResultOutcome</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ResultTest">
          <DataField>ResultTest</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ResultErrorMessage">
          <DataField>ResultErrorMessage</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ResultDuration">
          <DataField>ResultDuration</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="LastUpdatedByName">
          <DataField>LastUpdatedByName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BuildType">
          <DataField>BuildType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="PassedCount">
          <DataField>PassedCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="FailedCount">
          <DataField>FailedCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="LastPassed">
          <DataField>LastPassed</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="BuildDefinitions">
      <Query>
        <DataSourceName>TFSDataSource</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@TeamProject">
            <Value>=Parameters!TeamProject.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select BuildDefinitionName from BuildDetailsView where TeamProjectProjectNodeName = @TeamProject
GROUP BY BuildDefinitionName</CommandText>
      </Query>
      <Fields>
        <Field Name="BuildDefinitionName">
          <DataField>BuildDefinitionName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox10">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style>
                                  <FontSize>8pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Left</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox10</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox4">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>Result Test</Value>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox4</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>6.08542mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>8.59583mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>10.18333mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>4.67708mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <GaugePanel Name="GaugePanel7">
                          <StateIndicators>
                            <StateIndicator Name="Indicator1">
                              <GaugeInputValue>
                                <Value>=Sum(Fields!FailedCount.Value)</Value>
                                <Multiplier>1</Multiplier>
                                <DataElementOutput>NoOutput</DataElementOutput>
                              </GaugeInputValue>
                              <TransformationType>None</TransformationType>
                              <TransformationScope>Tablix1</TransformationScope>
                              <MinimumValue>
                                <Value>NaN</Value>
                                <Multiplier>1</Multiplier>
                              </MinimumValue>
                              <MaximumValue>
                                <Value>NaN</Value>
                                <Multiplier>1</Multiplier>
                              </MaximumValue>
                              <IndicatorStyle>None</IndicatorStyle>
                              <IndicatorImage>
                                <Source>External</Source>
                                <Value />
                              </IndicatorImage>
                              <ScaleFactor>1</ScaleFactor>
                              <IndicatorStates>
                                <IndicatorState Name="ThreeSymbolUnCircledCross">
                                  <StartValue>
                                    <Value>1</Value>
                                    <Multiplier>1</Multiplier>
                                  </StartValue>
                                  <EndValue>
                                    <Value>1</Value>
                                    <Multiplier>1</Multiplier>
                                  </EndValue>
                                  <Color>Red</Color>
                                  <ScaleFactor>1</ScaleFactor>
                                  <IndicatorStyle>ThreeSymbolUnCircledCross</IndicatorStyle>
                                  <IndicatorImage>
                                    <Source>External</Source>
                                    <Value />
                                  </IndicatorImage>
                                </IndicatorState>
                                <IndicatorState Name="ThreeSymbolUnCircledExclamation">
                                  <StartValue>
                                    <Value>2</Value>
                                    <Multiplier>1</Multiplier>
                                  </StartValue>
                                  <EndValue>
                                    <Value>2</Value>
                                    <Multiplier>1</Multiplier>
                                  </EndValue>
                                  <Color>Yellow</Color>
                                  <ScaleFactor>1</ScaleFactor>
                                  <IndicatorStyle>ThreeSymbolUnCircledExclamation</IndicatorStyle>
                                  <IndicatorImage>
                                    <Source>External</Source>
                                    <Value />
                                  </IndicatorImage>
                                </IndicatorState>
                                <IndicatorState Name="ThreeSymbolUnCircledCheck">
                                  <StartValue>
                                    <Value>0</Value>
                                    <Multiplier>1</Multiplier>
                                  </StartValue>
                                  <EndValue>
                                    <Value>0</Value>
                                    <Multiplier>1</Multiplier>
                                  </EndValue>
                                  <Color>Green</Color>
                                  <ScaleFactor>1</ScaleFactor>
                                  <IndicatorStyle>ThreeSymbolUnCircledCheck</IndicatorStyle>
                                  <IndicatorImage>
                                    <Source>External</Source>
                                    <Value />
                                  </IndicatorImage>
                                </IndicatorState>
                              </IndicatorStates>
                              <Angle>0</Angle>
                              <StateDataElementName />
                              <rd:IconsSet>ThreeUncircledSymbols</rd:IconsSet>
                              <Style>
                                <ShadowOffset>2pt</ShadowOffset>
                              </Style>
                              <Top>4</Top>
                              <Left>4</Left>
                              <Height>92</Height>
                              <Width>92</Width>
                            </StateIndicator>
                          </StateIndicators>
                          <AutoLayout>true</AutoLayout>
                          <BackFrame>
                            <Style>
                              <Border>
                                <Style>None</Style>
                              </Border>
                              <BackgroundColor>Gainsboro</BackgroundColor>
                              <BackgroundGradientType>DiagonalLeft</BackgroundGradientType>
                              <BackgroundGradientEndColor>Gray</BackgroundGradientEndColor>
                              <BackgroundHatchType>None</BackgroundHatchType>
                              <ShadowOffset>0pt</ShadowOffset>
                            </Style>
                            <FrameBackground>
                              <Style>
                                <BackgroundColor>Silver</BackgroundColor>
                                <BackgroundGradientType>DiagonalLeft</BackgroundGradientType>
                                <BackgroundGradientEndColor>Gray</BackgroundGradientEndColor>
                                <BackgroundHatchType>None</BackgroundHatchType>
                              </Style>
                            </FrameBackground>
                            <FrameImage>
                              <Source>External</Source>
                              <Value />
                            </FrameImage>
                          </BackFrame>
                          <TopImage>
                            <Source>External</Source>
                            <Value />
                          </TopImage>
                          <DataSetName>Builds</DataSetName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>White</BackgroundColor>
                          </Style>
                        </GaugePanel>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="LastPassed">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=IIF(Fields!DaysFailing.Value &gt;Parameters!NumberOfDays.Value, Parameters!NumberOfDays.Value, Fields!DaysFailing.Value)</Value>
                                  <Style>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>LastPassed</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>White</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="BuildDefinitionName">
                    <GroupExpressions>
                      <GroupExpression>=Fields!BuildDefinitionName.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!BuildDefinitionName.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>4.94167mm</Size>
                    <CellContents>
                      <Textbox Name="BuildDefinitionName">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!BuildDefinitionName.Value</Value>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Left</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>BuildDefinitionName</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Style>Solid</Style>
                            <Width>1pt</Width>
                          </BottomBorder>
                          <BackgroundColor>White</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="BuildName">
                        <GroupExpressions>
                          <GroupExpression>=Fields!BuildStartTime.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!BuildName.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember>
                          <TablixHeader>
                            <Size>5.47083mm</Size>
                            <CellContents>
                              <GaugePanel Name="GaugePanel6">
                                <StateIndicators>
                                  <StateIndicator Name="Indicator1">
                                    <GaugeInputValue>
                                      <Value>=Switch(Fields!BuildStatusName.Value = "Failed", - 1, Fields!BuildStatusName.Value = "Partially Succeeded", 0, Fields!BuildStatusName.Value = "Succeeded", 1)</Value>
                                      <Multiplier>1</Multiplier>
                                      <DataElementOutput>NoOutput</DataElementOutput>
                                    </GaugeInputValue>
                                    <TransformationType>None</TransformationType>
                                    <TransformationScope>Tablix1</TransformationScope>
                                    <MinimumValue>
                                      <Value>NaN</Value>
                                      <Multiplier>1</Multiplier>
                                    </MinimumValue>
                                    <MaximumValue>
                                      <Value>NaN</Value>
                                      <Multiplier>1</Multiplier>
                                    </MaximumValue>
                                    <IndicatorStyle>None</IndicatorStyle>
                                    <IndicatorImage>
                                      <Source>External</Source>
                                      <Value />
                                    </IndicatorImage>
                                    <ScaleFactor>1</ScaleFactor>
                                    <IndicatorStates>
                                      <IndicatorState Name="ThreeSymbolCross">
                                        <StartValue>
                                          <Value>-1</Value>
                                          <Multiplier>1</Multiplier>
                                        </StartValue>
                                        <EndValue>
                                          <Value>-1</Value>
                                          <Multiplier>1</Multiplier>
                                        </EndValue>
                                        <Color>Red</Color>
                                        <ScaleFactor>1</ScaleFactor>
                                        <IndicatorStyle>ThreeSymbolCross</IndicatorStyle>
                                        <IndicatorImage>
                                          <Source>External</Source>
                                          <Value />
                                        </IndicatorImage>
                                      </IndicatorState>
                                      <IndicatorState Name="ThreeSymbolExclamation">
                                        <StartValue>
                                          <Value>0</Value>
                                          <Multiplier>1</Multiplier>
                                        </StartValue>
                                        <EndValue>
                                          <Value>0</Value>
                                          <Multiplier>1</Multiplier>
                                        </EndValue>
                                        <Color>Yellow</Color>
                                        <ScaleFactor>1</ScaleFactor>
                                        <IndicatorStyle>ThreeSymbolExclamation</IndicatorStyle>
                                        <IndicatorImage>
                                          <Source>External</Source>
                                          <Value />
                                        </IndicatorImage>
                                      </IndicatorState>
                                      <IndicatorState Name="ThreeSymbolCheck">
                                        <StartValue>
                                          <Value>1</Value>
                                          <Multiplier>1</Multiplier>
                                        </StartValue>
                                        <EndValue>
                                          <Value>1</Value>
                                          <Multiplier>1</Multiplier>
                                        </EndValue>
                                        <Color>Green</Color>
                                        <ScaleFactor>1</ScaleFactor>
                                        <IndicatorStyle>ThreeSymbolCheck</IndicatorStyle>
                                        <IndicatorImage>
                                          <Source>External</Source>
                                          <Value />
                                        </IndicatorImage>
                                      </IndicatorState>
                                    </IndicatorStates>
                                    <Angle>0</Angle>
                                    <StateDataElementName />
                                    <rd:IconsSet>ThreeCircledSymbols</rd:IconsSet>
                                    <Style>
                                      <ShadowOffset>2pt</ShadowOffset>
                                    </Style>
                                    <Top>4</Top>
                                    <Left>4</Left>
                                    <Height>92</Height>
                                    <Width>92</Width>
                                  </StateIndicator>
                                </StateIndicators>
                                <AutoLayout>true</AutoLayout>
                                <BackFrame>
                                  <Style>
                                    <Border>
                                      <Style>None</Style>
                                    </Border>
                                    <BackgroundColor>Gainsboro</BackgroundColor>
                                    <BackgroundGradientType>DiagonalLeft</BackgroundGradientType>
                                    <BackgroundGradientEndColor>Gray</BackgroundGradientEndColor>
                                    <BackgroundHatchType>None</BackgroundHatchType>
                                    <ShadowOffset>0pt</ShadowOffset>
                                  </Style>
                                  <FrameBackground>
                                    <Style>
                                      <BackgroundColor>Silver</BackgroundColor>
                                      <BackgroundGradientType>DiagonalLeft</BackgroundGradientType>
                                      <BackgroundGradientEndColor>Gray</BackgroundGradientEndColor>
                                      <BackgroundHatchType>None</BackgroundHatchType>
                                    </Style>
                                  </FrameBackground>
                                  <FrameImage>
                                    <Source>External</Source>
                                    <Value />
                                  </FrameImage>
                                </BackFrame>
                                <TopImage>
                                  <Source>External</Source>
                                  <Value />
                                </TopImage>
                                <DataSetName>Builds</DataSetName>
                                <Style>
                                  <Border>
                                    <Color>LightGrey</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BottomBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </BottomBorder>
                                  <BackgroundColor>White</BackgroundColor>
                                </Style>
                              </GaugePanel>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                        <TablixMember>
                          <TablixHeader>
                            <Size>5.47083mm</Size>
                            <CellContents>
                              <Textbox Name="BuildName2">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>=Fields!BuildStartTime.Value</Value>
                                        <Style>
                                          <FontSize>8pt</FontSize>
                                          <FontWeight>Bold</FontWeight>
                                          <Format>dd/MM</Format>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style />
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>BuildName</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Color>LightGrey</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BottomBorder>
                                    <Color>Black</Color>
                                    <Style>Solid</Style>
                                    <Width>1pt</Width>
                                  </BottomBorder>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>5.47083mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox43">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>#Days</Value>
                                    <Style>
                                      <FontSize>8pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Right</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox43</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>LightGrey</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BottomBorder>
                                <Color>Black</Color>
                                <Style>Solid</Style>
                                <Width>1pt</Width>
                              </BottomBorder>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="ResultTest">
                    <GroupExpressions>
                      <GroupExpression>=Fields!ResultTest.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!ResultTest.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>101.06458mm</Size>
                    <CellContents>
                      <Textbox Name="ResultTest">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!ResultTest.Value</Value>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>ResultTest</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                  <Visibility>
                    <Hidden>=Sum(Fields!FailedCount.Value,"ResultTest") =0</Hidden>
                  </Visibility>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>Builds</DataSetName>
            <Top>17.21556mm</Top>
            <Left>0mm</Left>
            <Height>15.08958mm</Height>
            <Width>125.92916mm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Textbox Name="ReportTitle">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>FTP Build Failing Test Report</Value>
                    <Style>
                      <FontSize>20pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <Color>White</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>@</Value>
                    <Style>
                      <FontSize>8pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <Color>White</Color>
                    </Style>
                  </TextRun>
                  <TextRun>
                    <Value>=Parameters!BuildDate.Value</Value>
                    <Style>
                      <FontSize>8pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <Color>White</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>0mm</Top>
            <Height>15.45167mm</Height>
            <Width>238.38331mm</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <BackgroundColor>DarkBlue</BackgroundColor>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Textbox Name="Textbox205">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>Please note: </Value>
                    <Style>
                      <FontSize>9pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                  <TextRun>
                    <Value>This report shows the Status and automated test results for Nightly Builds. Only automated tests that did not pass detailed in the report. Further information is available in TFS.</Value>
                    <Style>
                      <FontSize>9pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox205</rd:DefaultName>
            <Top>40.71408mm</Top>
            <Left>0mm</Left>
            <Height>9.05355mm</Height>
            <Width>238.6479mm</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>50.2968mm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>263.38331mm</Width>
      <Page>
        <PageHeight>297mm</PageHeight>
        <PageWidth>210mm</PageWidth>
        <InteractiveHeight>0mm</InteractiveHeight>
        <InteractiveWidth>21cm</InteractiveWidth>
        <LeftMargin>20mm</LeftMargin>
        <RightMargin>20mm</RightMargin>
        <TopMargin>20mm</TopMargin>
        <BottomMargin>20mm</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="BuildDefinition">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Integration.Nightly</Value>
        </Values>
      </DefaultValue>
      <Prompt>Build Definition Pattern eg %Nightly</Prompt>
    </ReportParameter>
    <ReportParameter Name="BuildDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=Now()</Value>
        </Values>
      </DefaultValue>
      <Prompt>Build Date</Prompt>
    </ReportParameter>
    <ReportParameter Name="TeamProject">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Common</Value>
        </Values>
      </DefaultValue>
      <Prompt>Team Project</Prompt>
    </ReportParameter>
    <ReportParameter Name="NumberOfDays">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>7</Value>
        </Values>
      </DefaultValue>
      <Prompt>Number Of Days</Prompt>
    </ReportParameter>
    <ReportParameter Name="BuildDefinitions">
      <DataType>String</DataType>
      <Prompt>BuildDefinitions</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>BuildDefinitions</DataSetName>
          <ValueField>BuildDefinitionName</ValueField>
          <LabelField>BuildDefinitionName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Mm</rd:ReportUnitType>
  <rd:ReportServerUrl>http://tdc2tfs001/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>66e9104a-36ba-49af-8dd6-f22fbe369c00</rd:ReportID>
</Report>